<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Edit Buku: <%= book.judul %></title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Custom styling untuk meningkatkan tampilan */
      .sidebar-collapsed {
        width: 4rem !important;
      }
      .sidebar-expanded {
        width: 16rem !important;
      }
      .book-cover-preview {
        max-height: 300px;
        object-fit: contain;
      }
    </style>
  </head>
  <body class="bg-blue-50 min-h-screen font-sans text-gray-800">
    <!-- Sidebar Desktop -->
    <div
      id="desktop-sidebar"
      class="fixed inset-y-0 left-0 w-64 bg-white shadow-lg hidden md:block z-10 transition-all duration-300 sidebar-expanded"
    >
      <!-- Logo -->
      <div
        id="sidebar-logo"
        class="flex items-center justify-center h-16 border-b border-blue-200"
      >
        <img
          src="/images/aksararia.png"
          alt="AKSARARIA Logo"
          class="h-10 object-contain"
        />
      </div>

      <!-- Navigasi -->
      <div id="sidebar-nav" class="p-4 space-y-4">
        <a
          href="/"
          class="flex items-center text-blue-600 hover:text-blue-800 font-semibold p-2 rounded hover:bg-blue-50 group"
        >
          <span class="mr-3 text-lg">ğŸ </span>
          <span class="sidebar-text">Beranda</span>
        </a>
        <a
          href="/books/my-books"
          class="flex items-center text-blue-600 hover:text-blue-800 font-semibold p-2 rounded hover:bg-blue-50 group"
        >
          <span class="mr-3 text-lg">ğŸ“–</span>
          <span class="sidebar-text">Buku Saya</span>
        </a>
        <a
          href="/books/submit-book"
          class="flex items-center text-blue-600 hover:text-blue-800 font-semibold p-2 rounded hover:bg-blue-50 group"
        >
          <span class="mr-3 text-lg">ğŸ“š</span>
          <span class="sidebar-text">Submit Buku</span>
        </a>
        <a
          href="/books/my-books"
          class="flex items-center text-blue-600 hover:text-blue-800 font-semibold p-2 rounded hover:bg-blue-50 group"
        >
          <span class="mr-3 text-lg">ğŸ“–</span>
          <span class="sidebar-text">Buku Saya</span>
        </a>
        <a
          href="/logout"
          class="flex items-center text-red-600 hover:text-red-800 font-semibold p-2 rounded hover:bg-red-50 group"
        >
          <span class="mr-3 text-lg">ğŸšª</span>
          <span class="sidebar-text">Logout</span>
        </a>
      </div>

      <!-- Tombol Toggle Sidebar -->
      <button
        id="toggle-sidebar"
        class="absolute bottom-4 left-1/2 transform -translate-x-1/2 text-blue-600 hover:text-blue-800 p-2 rounded-full bg-blue-100 hover:bg-blue-200 transition-all"
      >
        <svg
          id="toggle-icon"
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            id="toggle-path"
            d="M15 19l-7-7 7-7"
          />
        </svg>
      </button>
    </div>

    <!-- Sidebar Mobile -->
    <div
      id="mobile-sidebar"
      class="md:hidden fixed inset-0 z-50 bg-white w-64 shadow-lg transform -translate-x-full transition-transform duration-300"
    >
      <div
        class="flex justify-between items-center p-4 border-b border-blue-200"
      >
        <img
          src="/images/aksararia.png"
          alt="AKSARARIA Logo"
          class="h-8 object-contain"
        />
        <button
          id="close-mobile-sidebar"
          class="text-gray-500 hover:text-gray-700 text-2xl"
        >
          &times;
        </button>
      </div>
      <div class="p-4 space-y-4">
        <a
          href="/"
          class="block text-blue-600 hover:text-blue-800 font-semibold"
          >ğŸ  Beranda</a
        >
        <a
          href="/books/my-books"
          class="block text-blue-600 hover:text-blue-800 font-semibold"
          >ğŸ“– Buku Saya</a
        >
        <a
          href="/books/submit-book"
          class="block text-blue-600 hover:text-blue-800 font-semibold"
          >ğŸ“š Submit Buku</a
        >
        <a
          href="/books/my-books"
          class="block text-blue-600 hover:text-blue-800 font-semibold"
          >ğŸ“– Buku Saya</a
        >
        <a
          href="/logout"
          class="block text-red-600 hover:text-red-800 font-semibold"
          >ğŸšª Logout</a
        >
      </div>
    </div>

    <!-- Tombol Hamburger untuk Mobile -->
    <button
      id="mobile-menu-toggle"
      class="md:hidden fixed bottom-4 right-4 z-40 bg-blue-500 text-white p-3 rounded-full shadow-md hover:shadow-lg"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-6 w-6"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 6h16M4 12h16M4 18h16"
        />
      </svg>
    </button>

    <!-- Konten Utama -->
    <div id="main-content" class="md:ml-64 p-6 transition-all duration-300">
      <!-- Header -->
      <header class="flex items-center gap-4 mb-8">
        <img
          src="/images/aksararia.png"
          alt="AKSARARIA Logo"
          class="h-12 object-contain hidden md:block"
        />
        <div>
          <h1 id="book-title" class="text-3xl font-bold text-blue-800">
            AKSARARIA
          </h1>
          <p class="text-lg text-blue-600">
            Temukan & Rekomendasikan Buku Terbaik
          </p>
        </div>
      </header>

      <!-- Judul Halaman -->
      <div class="max-w-4xl mx-auto">
        <h1 class="text-2xl font-bold text-blue-800 mb-6 flex items-center">
          <span class="mr-2">âœï¸</span> Edit Buku: <%= book.judul %>
        </h1>

        <!-- Flash Messages -->
        <% if (success_msg) { %>
        <div
          class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded mb-6"
        >
          <p><%= success_msg %></p>
        </div>
        <% } %> <% if (error_msg) { %>
        <div
          class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded mb-6"
        >
          <p><%= error_msg %></p>
        </div>
        <% } %>

        <!-- Form Edit Buku -->
        <div class="bg-white rounded-lg shadow-md p-6">
          <form
            action="/books/edit/<%= book.id %>"
            method="POST"
            enctype="multipart/form-data"
            class="space-y-6"
          >
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Preview Sampul -->
              <div class="md:col-span-1">
                <h2 class="text-lg font-semibold text-blue-800 mb-3">
                  Preview Sampul
                </h2>
                <div class="border border-blue-200 rounded-lg overflow-hidden">
                  <% if (book.sampul_url) { %>
                  <img
                    src="<%= book.sampul_url %>"
                    alt="Preview sampul <%= book.judul %>"
                    class="w-full book-cover-preview"
                  />
                  <% } else { %>
                  <div
                    class="w-full h-64 bg-gray-100 flex items-center justify-center text-gray-400"
                  >
                    Sampul Tidak Tersedia
                  </div>
                  <% } %>
                </div>
              </div>

              <!-- Form Fields -->
              <div class="md:col-span-1 space-y-4">
                <div>
                  <label
                    class="block text-sm font-medium text-gray-700 mb-1 flex items-center"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-4 w-4 mr-1"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"
                      />
                    </svg>
                    Judul Buku
                  </label>
                  <input
                    type="text"
                    name="judul"
                    value="<%= book.judul %>"
                    required
                    class="w-full px-4 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"
                  />
                </div>

                <div>
                  <label
                    class="block text-sm font-medium text-gray-700 mb-1 flex items-center"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-4 w-4 mr-1"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                      />
                    </svg>
                    Penulis
                  </label>
                  <input
                    type="text"
                    name="penulis"
                    value="<%= book.penulis %>"
                    required
                    class="w-full px-4 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"
                  />
                </div>

                <div>
                  <label
                    class="block text-sm font-medium text-gray-700 mb-1 flex items-center"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-4 w-4 mr-1"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V7a2 2 0 012-2h4m-4 0a2 2 0 01-2-2"
                      />
                    </svg>
                    Genre
                  </label>
                  <input
                    type="text"
                    name="genre"
                    value="<%= book.genre || '' %>"
                    class="w-full px-4 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"
                  />
                </div>

                <div>
                  <label
                    class="block text-sm font-medium text-gray-700 mb-1 flex items-center"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-4 w-4 mr-1"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                      />
                    </svg>
                    Tahun Terbit
                  </label>
                  <input
                    type="number"
                    name="tahun_terbit"
                    value="<%= book.tahun_terbit || '' %>"
                    class="w-full px-4 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"
                  />
                </div>
              </div>
            </div>

            <!-- Deskripsi dan Link -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label
                  class="block text-sm font-medium text-gray-700 mb-1 flex items-center"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4 mr-1"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M13 10V3L4 14h7v7l9-11h-7z"
                    />
                  </svg>
                  Deskripsi
                </label>
                <textarea
                  name="deskripsi"
                  rows="5"
                  class="w-full px-4 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"
                >
<%= book.deskripsi || '' %></textarea
                >
              </div>

              <div>
                <label
                  class="block text-sm font-medium text-gray-700 mb-1 flex items-center"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4 mr-1"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M13 10V3L4 14h7v7l9-11h-7z"
                    />
                  </svg>
                  Link Baca/Beli
                </label>
                <input
                  type="text"
                  name="link_baca_beli"
                  value="<%= book.link_baca_beli || '' %>"
                  class="w-full px-4 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"
                />
              </div>
            </div>

            <!-- Upload Sampul -->
            <div>
              <label
                class="block text-sm font-medium text-gray-700 mb-1 flex items-center"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-4 w-4 mr-1"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                  />
                </svg>
                Upload Sampul Buku (opsional)
              </label>
              <input
                type="file"
                name="sampul"
                accept="image/*"
                class="w-full px-4 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"
              />
            </div>

            <!-- Tombol Submit -->
            <div class="flex justify-end">
              <button
                type="submit"
                class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 flex items-center"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-4 w-4 mr-2"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M8 7H5m3 0a1 1 0 011-1h4a1 1 0 011 1m-4 0v5a1 1 0 001 1h2a1 1 0 001-1v-5m-6 0h8"
                  />
                </svg>
                Ajukan Perubahan
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Script Toggle Sidebar -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // --- Script untuk Sidebar Mobile ---
        const menuToggle = document.getElementById("mobile-menu-toggle");
        const closeSidebar = document.getElementById("close-mobile-sidebar");
        const mobileSidebar = document.getElementById("mobile-sidebar");

        if (menuToggle && closeSidebar && mobileSidebar) {
          menuToggle.addEventListener("click", () => {
            mobileSidebar.classList.remove("-translate-x-full");
            mobileSidebar.classList.add("translate-x-0");
          });

          closeSidebar.addEventListener("click", () => {
            mobileSidebar.classList.add("-translate-x-full");
            mobileSidebar.classList.remove("translate-x-0");
          });

          // Tutup sidebar saat klik di luar
          document.addEventListener("click", (e) => {
            if (
              !mobileSidebar.contains(e.target) &&
              !e.target.closest("#mobile-menu-toggle")
            ) {
              mobileSidebar.classList.add("-translate-x-full");
              mobileSidebar.classList.remove("translate-x-0");
            }
          });
        } else {
          console.warn("Elemen sidebar mobile tidak ditemukan.");
        }

        // --- Script untuk Sidebar Desktop (Minimize/Expand) ---
        const toggleBtn = document.getElementById("toggle-sidebar");
        const sidebar = document.getElementById("desktop-sidebar");
        const mainContent = document.getElementById("main-content");
        const sidebarTexts = document.querySelectorAll(".sidebar-text");
        const iconPath = document.getElementById("toggle-path");

        if (
          toggleBtn &&
          sidebar &&
          mainContent &&
          sidebarTexts.length > 0 &&
          iconPath
        ) {
          let isCollapsed = false; // Status sidebar saat ini

          // Fungsi untuk toggle sidebar
          function toggleSidebar() {
            isCollapsed = !isCollapsed;
            if (isCollapsed) {
              // --- Collapse Sidebar ---
              sidebar.classList.remove("w-64", "sidebar-expanded");
              sidebar.classList.add("w-16", "sidebar-collapsed");

              // Sembunyikan teks navigasi
              sidebarTexts.forEach((text) => text.classList.add("hidden"));

              // Geser konten utama
              mainContent.classList.remove("md:ml-64");
              mainContent.classList.add("md:ml-16");

              // Ubah ikon toggle
              iconPath.setAttribute("d", "M9 5l7 7-7 7");
            } else {
              // --- Expand Sidebar ---
              sidebar.classList.remove("w-16", "sidebar-collapsed");
              sidebar.classList.add("w-64", "sidebar-expanded");

              // Tampilkan teks navigasi
              sidebarTexts.forEach((text) => text.classList.remove("hidden"));

              // Geser konten utama kembali
              mainContent.classList.remove("md:ml-16");
              mainContent.classList.add("md:ml-64");

              // Ubah ikon toggle
              iconPath.setAttribute("d", "M15 19l-7-7 7-7");
            }
          }

          // Tambahkan event listener ke tombol toggle
          toggleBtn.addEventListener("click", toggleSidebar);

          // Simpan status toggle di localStorage
          const savedState = localStorage.getItem("editBookSidebarCollapsed");
          if (savedState === "true") {
            toggleSidebar();
          }

          toggleBtn.addEventListener("click", () => {
            localStorage.setItem("editBookSidebarCollapsed", isCollapsed);
          });
        } else {
          console.warn("Elemen sidebar desktop atau toggle tidak ditemukan.");
        }
      });
    </script>
  </body>
</html>
