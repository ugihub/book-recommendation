<!DOCTYPE html>
<html>
  <head>
    <title>Buku Saya</title>
  </head>
  <body>
    <h2>Buku Saya</h2>

    <% if (success_msg) { %>
    <div class="flash-message success"><%= success_msg %></div>
    <% } %> <% if (error_msg) { %>
    <div class="flash-message error"><%= error_msg %></div>
    <% } %>

    <!-- Tambahkan kolom status edit -->
    <table>
      <thead>
        <tr>
          <th>Judul</th>
          <th>Penulis</th>
          <th>Status</th>
          <th>Tanggal Pengajuan</th>
          <th>Status Edit</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody>
        <% if (books && books.length > 0) { %> <% books.forEach(book => { %>
        <tr>
          <td><%= book.judul %></td>
          <td><%= book.penulis %></td>
          <td><%= book.status %></td>
          <td><%= book.created_at.toLocaleDateString() %></td>
          <td>
            <% if (book.edit_status === 'pending') { %>
            <span style="color: orange">Menunggu Persetujuan</span>
            <% } else if (book.edit_status === 'approved') { %>
            <span style="color: green">Perubahan Disetujui</span>
            <% } else { %>
            <span style="color: gray">Belum Ada Edit</span>
            <% } %>
          </td>
          <td>
            <% if (book.edit_status !== 'pending') { %>
            <a href="/books/edit/<%= book.id %>">Edit</a>
            <% } else { %>
            <em>Edit menunggu persetujuan</em>
            <% } %>
          </td>
        </tr>
        <% }) %> <% } else { %>

        <!-- Tambahkan notifikasi -->
        <% if (success_msg) { %>
        <div class="flash-message success"><%= success_msg %></div>
        <% } %> <% if (error_msg) { %>
        <div class="flash-message error"><%= error_msg %></div>
        <% } %>
        <tr>
          <td colspan="6">Belum ada buku yang disetujui.</td>
        </tr>
        <% } %>
      </tbody>
    </table>

    <p><a href="/">Kembali ke Beranda</a></p>
  </body>
</html>
